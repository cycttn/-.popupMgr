/* MIT LICENSE */
(function(e){function l(){return u.clone().appendTo("body")}function c(){return r[parseInt(e(this).attr(n))]}function h(s,u){var a=e.extend({},t,u),f=a.on.toLowerCase(),l=a.off.toLowerCase();a.data=s;r[i]=a;r[i].tm=null;e(this).attr(n,i++);if(!a.name)a.name="main";try{e.popupMgr.create(a.name)}catch(h){}var p=f==l&&f;if(p){e(this).on(f,function(){var t=c.call(this);if(!t.currClicked||o!==this){e.popupMgr.show(this);t.currClicked=true}else{e.popupMgr.hide(t.name,t.animate,t.delay);t.currClicked=false}})}else{if(f)e(this).on(f,function(){e.popupMgr.show(this)});if(l)e(this).on(l,function(){if(o!==this)return;var t=c.call(this);e.popupMgr.hide(t.name,t.animate,t.delay)})}}var t={name:"main","class":"",on:"mouseover",off:"mouseout",delay:0,animate:false,offy:3,"static":false,currClicked:false};var n="popupMgr-id",r={},i=1,s="",o=null,u=e("<div />").addClass("popupMgr hidden"),a={};var f={};e.popupMgr={invoked:function(e){return e&&f[e]?f[e]:o},create:function(e){if(a[e])throw'popupMgr: popupMgr by name "'+e+'" already exists!';a[e]=l()},update:function(e,t){if(!a[e])throw'popupMgr: popupMgr by name "'+e+"\" doesn't exist!";a[e].html(t)},_changeClass:function(e,t){if(s!="")a[t].removeClass(s);s=(e||"").trim();if(s!="")a[t].addClass(s)},_showNoAnim:function(e){a[e].removeClass("hidden")},_hideNoAnim:function(e){a[e].addClass("hidden")},_dim:function(e){var t=e.offset();return{x:t.left,y:t.top,w:e.outerWidth(),h:e.outerHeight()}},_wnd:function(){return{h:e(window).height(),w:e(window).width(),sy:e(window).scrollTop()}},pos:function(t,n,r,i,s,o){var u=this._wnd();if(!t){var a=this._dim(r),f=u.h+u.sy>a.y+a.h+o+s?a.y+a.h+o:a.y-s-o;n.css({position:"absolute",top:f,left:a.x,width:a.w})}else if(!e.isArray(t)){throw"popupMgr: Property 'static' in options must be an array or equivalent to boolean false"}else if(t.length<2){throw"popupMgr: Property 'static' in options must have at least length 2"}else{if(t[2])i=t[2];if(t[3])s=t[3];if(t[0]==-1)t[0]=(u.w-i)/2;if(t[1]==-1)t[1]=(u.h-s)/2;n.css({position:"fixed",left:t[0],top:t[1],width:i,height:s})}},html:function(e,t){e.contents().detach();if(t instanceof jQuery)e.append(t);else e.html(t)},show:function(t,n){var r=e(t);if(!n)n=c.call(r);var i=a[n.name];if(t===o){n.animate?i.show(n.delay):this._showNoAnim(n.name);return}o=t;f[n.name]=t;e.popupMgr.html(i,n.data);this._changeClass(n.cls,n.name);this._showNoAnim(n.name);var s=i.outerWidth(),u=i.outerHeight();this._hideNoAnim(n.name);e.popupMgr.pos(n.static,i,r,s,u,n.offy);n.animate?i.show(n.delay):this._showNoAnim(n.name)},hide:function(e,t,n){t?a[e].hide(n):this._hideNoAnim(e)}};e.fn.popupMgr=function(t,i){var s=this.attr(n);if(!s){return this.each(function(){h.call(this,t,i)})}s=parseInt(s);if(i){r[s]=e.extend({},r[s],i)}if(t!==null){r[s].data=t;e.popupMgr.html(a[r[s].name],t)}if(o==this.get(0))o=null;return this};})(jQuery)